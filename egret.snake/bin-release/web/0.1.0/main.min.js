var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Color=function(){function t(){this.ColorList=[8280002,6056896,15684432,15483002,11225020,4367861,2733814,2541274,2533018,16754470]}return t.prototype.getColor=function(){var t=Math.round(Math.random()*this.ColorList.length);return this.ColorList[t]},t}();__reflect(Color.prototype,"Color");var Food=function(t){function e(e,i,s){var h=t.call(this)||this;return h.init(e,i,s),h}return __extends(e,t),e.prototype.init=function(t,e,i){this.color=new Color,this.colornum=this.color.getColor(),this.food=new egret.Shape,this.food.graphics.beginFill(this.colornum),this.food.graphics.drawCircle(0,0,i),this.food.graphics.endFill(),this.food.x=i,this.food.y=i,this.x=t,this.y=e,this.addChild(this.food)},e}(egret.Sprite);__reflect(Food.prototype,"Food");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.radius=20,e.interval=200,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createGameScene,e),e}return __extends(e,t),e.prototype.createGameScene=function(){var t=new egret.Shape;t.graphics.beginFill(16764092),t.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageWidth),t.graphics.endFill(),this.addChild(t),this.randomFood(),this.snake=new Snake(100,100,20,50),this.addChild(this.snake),mouse.enable(this.stage),mouse.setMouseMoveEnabled(!0),this.touchEnabled=!0,this.addEventListener(mouse.MouseEvent.MOUSE_MOVE,this.move,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.startTouchAccelerate,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.endTouchAccelerate,this)},e.prototype.move=function(t){this.moveEvent=t,null==this.timer&&(this.timer=new egret.Timer(this.interval),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.start())},e.prototype.onEat=function(){this.removeChild(this.food),this.snake.afterEat(this.food.colornum),this.randomFood()},e.prototype.onTimer=function(){this.hit(this.snake.head,this.food)&&this.onEat(),this.snake.Move(this.moveEvent,this.interval)},e.prototype.randomFood=function(){var t=Math.random()*(this.stage.stageWidth-2*this.radius),e=Math.random()*(this.stage.stageHeight-2*this.radius);this.food=new Food(t,e,this.radius),this.addChild(this.food)},e.prototype.hit=function(t,e){return new egret.Rectangle(t.x+this.snake.x,t.y+this.snake.y,t.width,t.height).intersects(new egret.Rectangle(e.x,e.y,e.width,e.height))},e.prototype.startTouchAccelerate=function(t){(80!=this.interval||1==this.hasEventListener(mouse.MouseEvent.MOUSE_MOVE))&&(this.interval=80,this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer=null,this.removeEventListener(mouse.MouseEvent.MOUSE_MOVE,this.move,this)),this.moveEvent=t,null==this.timer&&(this.timer=new egret.Timer(this.interval),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.start())},e.prototype.endTouchAccelerate=function(){this.interval=200,this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer=null,this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),this.addEventListener(mouse.MouseEvent.MOUSE_MOVE,this.move,this),console.log(this.hasEventListener(mouse.MouseEvent.MOUSE_MOVE))},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Snake=function(t){function e(e,i,s,h){var o=t.call(this)||this;return o.headColor=new Color,o.body=[],o.speed=30,o.Create(e,i,s,h),o}return __extends(e,t),e.prototype.Create=function(t,e,i,s){this.head=new egret.Shape,this.head.graphics.lineStyle(5,4207154),this.head.graphics.beginFill(this.headColor.getColor()),this.head.graphics.drawCircle(i,i,i),this.head.graphics.endFill(),this.head.x=0,this.head.y=0,this.radius=20,this.x=t,this.y=e,this.body.push(this.head),this.addChild(this.head),this.setChildIndex(this.head,-999);for(var h=1;s-1>=h;h++){var o=new Color,r=new egret.Shape;r.graphics.beginFill(o.getColor()),r.graphics.drawCircle(i,i,i),r.graphics.endFill(),r.x=this.body[this.body.length-1].x+i,r.y=this.body[this.body.length-1].y+i,this.body.push(r),this.addChild(this.body[this.body.length-1]),this.setChildIndex(this.body[this.body.length-1],0)}},e.prototype.Move=function(t,e){var i,s=t.stageX,h=t.stageY,o=this.x+this.body[0].x,r=this.y+this.body[0].y;i=egret.Tween.get(this.body[0]);var n=Math.sqrt((s-o)*(s-o)+(h-r)*(h-r)),a=(s-o)/n,d=(h-r)/n;if(!(a*n*a*n+d*n*d*n<=this.speed*this.speed)){var l=this.body[0].x+this.speed*a,c=this.body[0].y+this.speed*d;i.to({x:l,y:c},e);for(var g=this.body.length-1;g>=1;g--)i=egret.Tween.get(this.body[g]),i.to({x:this.body[g-1].x,y:this.body[g-1].y},e)}},e.prototype.afterEat=function(t){var e=new egret.Shape;e.graphics.beginFill(t),e.graphics.drawCircle(this.radius,this.radius,this.radius),e.graphics.endFill(),e.x=this.body[this.body.length-1].x+this.radius,e.y=this.body[this.body.length-1].y+this.radius,this.body.push(e),this.addChild(e),this.setChildIndex(this.body[this.body.length-1],0)},e}(egret.Sprite);__reflect(Snake.prototype,"Snake");